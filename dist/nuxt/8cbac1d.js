(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{1105:function(e,t,r){var content=r(1181);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(37).default)("ceecf9ba",content,!0,{sourceMap:!1})},1180:function(e,t,r){"use strict";r(1105)},1181:function(e,t,r){var n=r(36)(!1);n.push([e.i,"\n#map-wrap[data-v-4c17faee] {\r\n  margin-top: 10px;\r\n  height: 100%;\r\n  width: 100%;\r\n  height: calc(100vh - 160px);\n}\n#leafletEl[data-v-4c17faee], .vue2leaflet-map[data-v-4c17faee] {\r\n  z-index: 0;\n}\n.map-actions[data-v-4c17faee] {\r\n  position: absolute;\r\n  bottom: 40vh;\r\n  right: 12px;\r\n  z-index: 5;\n}\n.map-search[data-v-4c17faee] {\r\n  position: absolute;\r\n  left: 12px;\r\n  top: 12px;\r\n  z-index: 5;\r\n  margin-right: 12px;\n}\n.map-slider[data-v-4c17faee] {\r\n  position: absolute;\r\n  z-index: 1;\r\n  width: 100%;\r\n  bottom: 7vh;\n}\r\n",""]),e.exports=n},1251:function(e,t,r){"use strict";r.r(t);var n=r(739),l=r(174),o=r(0),c=(r(19),r(4),r(15),r(16),r(6)),y=Object(c.b)({name:"MapPage",middleware:"authenticated",transition:function(e,t){return t&&+e.query.page<+t.query.page?"slide-right":"slide-left"},setup:function(){var e=Object(c.q)(),t=e.state,r=e.dispatch,n=Object(c.l)(),l=n.$config,y=n.$capacitor,f=n.$system,d=n.$vuetify,m=n.$helper,v=Object(c.i)(!0),T=Object(c.i)(null),w=Object(c.i)([]),h=Object(c.a)((function(){return t.user.gps})),x=Object(c.a)((function(){return t.user})),O=Object(c.i)([]),j=Object(c.i)([]),k=Object(c.i)(!1),M=Object(c.i)(!1),R=Object(c.i)(null),I=Object(c.i)(!1),F=Object(c.i)(!1),P=Object(c.i)(!1),C=Object(c.i)({});y.positionPermissions(),Object(c.m)(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:case"end":return e.stop()}}),e)}))));var _=function(e){var t=e.title,title=void 0===t?"Marker":t,r=e.label,label=void 0===r?null:r,n=e.lat,l=void 0===n?null:n,o=e.lng,c=void 0===o?null:o,y=e.content,content=void 0===y?null:y,f=e.iconUrl,d=void 0===f?"MapIconScaled.svg":f,m=e.iconX,v=void 0===m?30:m,T=e.iconY,w=void 0===T?30:T,h=e.id,x=void 0===h?null:h;C.value[x]=new window.google.maps.Marker({map:R.value,position:new window.google.maps.LatLng(l,c),title:title,label:label,icon:{url:"map/".concat(d),scaledSize:new window.google.maps.Size(v,w),origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(v/2,w/2)}});var O='<div id="content">'.concat(content,"</div>"),j=new window.google.maps.InfoWindow({content:O,maxWidth:200});C.value[x].addListener("click",(function(){j.open({anchor:C.value[x],map:R.value,shouldFocus:!1})}))},L=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.value=!0,e.prev=1,e.next=4,r("user/friends/getAll",{uid:x.value.uid}).then((function(e){!1!==e&&(w.value=e)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),f.log({comp:"MapPage",msg:"Not able to get friends for map",val:e.t0});case 9:return e.prev=9,v.value=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})));return function(){return e.apply(this,arguments)}}(),A=function(e){var t,r=e.lat,n=void 0===r?null:r,l=e.lng,o=void 0===l?null:l;n&&o&&(t=new window.google.maps.LatLng(n,o),R.value.panTo(t))},S=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R.value&&R.value.addListener("dragend",Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.value=[R.value.getCenter().lat(),R.value.getCenter().lng()],console.log("STICKY: Your dragging the map around, new center is",O.value);case 2:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.sleep(1500);case 2:R.value=new window.google.maps.Map(document.getElementById("map"),{zoom:13,mapTypeId:window.google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0}),window.currentMap=R.value,x.value.gps.lat?(console.log("Init map with a center of",x.value.gps.lat),A({lat:x.value.gps.lat,lng:x.value.gps.lng})):console.log("STICKY: not able to center map with empty coords"),d.theme.dark?R.value.setOptions({styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"geometry",stylers:[{color:"#242A33"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242A33"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#abc6b4"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#abc6b4"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#666666"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#666666"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#999999"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b5b5b5"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]}):R.value.setOptions({styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"geometry",stylers:[{color:"#F6F8FA"}]},{elementType:"labels.text.stroke",stylers:[{color:"#F6F8FA"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#abc6b4"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#abc6b4"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#dddddd"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#dddddd"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#999999"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b5b5b5"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#d4e7f9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#d4e7f9"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#d4e7f9"}]}]}),k.value=!0,M.value=!0;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.f)(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P.value=!0;try{h.value&&h.value.lat||y.watchPosition()}catch(e){f.log({comp:"MapPage",msg:"Not able to get position",val:e})}finally{v.value=!1}case 2:case"end":return e.stop()}}),e)})))),Object(c.g)((function(){y.clearWatchPosition()})),Object(c.s)(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P.value){e.next=13;break}if(!window.google||!0===k.value||R.value){e.next=13;break}return e.next=4,E();case 4:return e.next=6,S();case 6:if(!x.value.gps||!x.value.gps.lat){e.next=9;break}return e.next=9,_({id:x.value.data.uid,lat:x.value.gps.lat,lng:x.value.gps.lng,title:"You",content:"You"});case 9:if(console.log("STICKY: INIT MAP DONE"),!(!F.value&&w.value&&w.value.length>0)){e.next=13;break}return e.next=13,void((t=w.value)&&(F.value=!0,t.forEach((function(e){e.gps&&e.gps.lat&&e.permissions.shareLocationWithFriends&&_({id:e.id,lat:e.gps.lat,lng:e.gps.lng,iconUrl:"FriendIcon.svg",title:"".concat(e.first_name?e.first_name:e.username),content:'<div class="d-flex align-center"><v-img src="'.concat(e.photoURL,'" /><h4>').concat(e.first_name?e.first_name:e.username,"</h4></div>")})}))));case 13:case"end":return e.stop()}var t}),e)})))),Object(c.r)(h,(function(e,t){var marker,r,n;console.log("STICKY: WATCH GPS",h.value,t),parseFloat(e.lat)!==t.lat&&h.value&&!0===k.value&&(marker=C[x.value.data.uid],r=h.value.lat,n=h.value.lng,marker&&marker.setPosition(new window.google.maps.LatLng(r,n)))})),Object(c.n)({title:"".concat(l.appTitle," on Map view"),meta:[{hid:"description",name:"description",content:"".concat(l.appTitle," on Map view")}]}),{loading:v,friends:w,googleMapEl:T,gps:h,slider:j,mapError:I,user:x,centerOn:A}},head:{}}),f=y,d=(r(1180),r(42)),component=Object(d.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"map-actions"},[r("div",[r(n.a,{attrs:{elevation:"0",fab:"",small:"",color:"primary"},on:{click:function(t){return e.centerOn({lat:e.user.gps.lat,lng:e.user.gps.lng})}}},[r(l.a,[e._v("\n          mdi-crosshairs-gps\n        ")])],1)],1)]),e._v(" "),r("div",{ref:"googleMapEl",staticStyle:{width:"calc(100vw)",height:"calc(100vh - 75px)"},attrs:{id:"map"}}),e._v(" "),r("div",{staticClass:"map-slider"},[r("FriendsMapslider",{staticClass:"mb-10",attrs:{friends:e.friends}})],1)])}),[],!1,null,"4c17faee",null);t.default=component.exports;installComponents(component,{FriendsMapslider:r(1216).default})}}]);