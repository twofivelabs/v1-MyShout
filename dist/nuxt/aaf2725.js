(window.webpackJsonp=window.webpackJsonp||[]).push([[85,73],{1325:function(e,t,n){"use strict";n.r(t);var r=n(675),o=n(793),c=n(743),l=n(0),m=(n(130),n(14),n(7)),d=n(718),f=n(801),h=n.n(f),v=(n(802),Object(m.b)({name:"FormsLoginbyphone",components:{VuePhoneNumberInput:h.a},props:{goTo:{type:String,default:"/register"}},setup:function(e){var t=Object(m.l)(),n=t.$fire,r=t.$fireModule,o=t.$notify,c=t.$system,f=t.i18n,h=Object(m.p)(),v=Object(m.i)(!1),x=Object(m.i)(!0),y=Object(m.i)(null),w=d.a,_=Object(m.i)(null),form=Object(m.i)({phone:"",phoneNumber:null,phoneNumberFormatted:null,showOtpInput:!1,otpProvided:null}),N=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.value=!0,e.next=3,_.value.validate();case 3:if(x.value=e.sent,!x.value){e.next=7;break}return e.next=7,O();case 7:v.value=!1;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!form.value.phone){t.next=18;break}return form.value.showOtpInput=!0,t.prev=2,t.next=5,n.auth.signInWithPhoneNumber(form.value.phone.trim().toLowerCase(),y.value);case 5:window.confirmationResult=t.sent,t.next=16;break;case 8:if(t.prev=8,t.t0=t.catch(2),k(),c.log({comp:"FormsLoginbyphone",msg:"Error trying to register phone number",val:t.t0}),o.show({text:f.t("notify.error_try_again"),color:"error"}),!e.goTo){t.next=16;break}return t.next=16,h.push(e.goTo);case 16:t.next=20;break;case 18:k(),o.show({text:f.t("notify.error_try_again"),color:"error"});case 20:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(){return t.apply(this,arguments)}}(),P=function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("FormsLoginbyphone: Starting OPT Code Confirmation"),v.value=!0,window.confirmationResult.confirm(form.value.otpProvided).then((function(t){return console.log("FormsLoginbyphone: OTP Code Login Success",t),t.additionalUserInfo.isNewUser?(o.show({text:f.t("notify.success"),color:"green"}),e.goTo?h.push(e.goTo):void h.push("/profile")):(o.show({text:f.t("notify.success"),color:"green"}),void h.push("/"))})).catch((function(e){k(),c.log({comp:"FormsLoginbyphone",msg:"Error with phone code",val:e}),o.show({text:f.t("notify.error_try_again"),color:"error"})})),v.value=!1;case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),k=function(){try{y.value=new r.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible",callback:function(){console.log("WORKS")}})}catch(e){console.log("Loginbyphone > initRecaptcha",e)}};return Object(m.f)((function(){k()})),{loading:v,valid:x,form:form,formEl:_,rules:w,updatePhoneNumber:function(e){form.value.phoneNumberFormatted=e.formattedNumber,form.value.phone=e.formattedNumber},validate:N,register:O,registerWithOTPCode:P}}})),x=v,y=n(58),component=Object(y.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(o.a,{ref:"formEl",on:{submit:function(t){return t.preventDefault(),e.validate.apply(null,arguments)}}},[e.form.showOtpInput?e._e():n("div",[n("VuePhoneNumberInput",{staticClass:"my-6 phoneNumberInput",attrs:{required:"",translations:{countrySelectorLabel:""}},on:{update:function(t){return e.updatePhoneNumber(t)}},model:{value:e.form.phoneNumberFormatted,callback:function(t){e.$set(e.form,"phoneNumberFormatted",t)},expression:"form.phoneNumberFormatted"}}),e._v(" "),n("div",{staticClass:"text-center mt-10"},[n(r.a,{staticClass:"text-center",attrs:{disabled:!e.valid,loading:e.loading,color:"success",elevation:"0",id:"recaptcha-container",type:"submit"}},[e._v("\n        "+e._s(e.$t("btn.send_code"))+"\n      ")])],1)],1),e._v(" "),e.form.showOtpInput?n("div",[n("ElementH3",{attrs:{text:e.$t("heading.we_sent_you_sms_code"),align:"left"}}),e._v(" "),n(c.a,{staticClass:"mt-5",attrs:{label:e.$t("form.code"),placeholder:e.$t("form.code"),outlined:"",max:"6",type:"number",oninput:"if(Number(this.value.length) > Number(this.max)) this.value = this.value.substring(0, Number(this.max));"},model:{value:e.form.otpProvided,callback:function(t){e.$set(e.form,"otpProvided",t)},expression:"form.otpProvided"}}),e._v(" "),n("div",{staticClass:"text-center"},[n(r.a,{staticClass:"text-center",attrs:{loading:e.loading,color:"success",elevation:"0",type:"submit"},on:{click:e.registerWithOTPCode}},[e._v("\n        "+e._s(e.$t("btn.login"))+"\n      ")])],1)],1):e._e()])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{ElementH3:n(720).default})},718:function(e,t,n){"use strict";n(31);t.a={email:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+\..+/.test(e)||"E-mail must be valid"}],password:[function(e){return!!e||"Password is required"},function(e){return e&&e.length>=6||"Password must be at least 6 characters"}],phone:[function(e){return!!e||"Phone is required"},function(e){return e&&e.length>=10||"Phone must be valid"}],message:[function(e){return!!e||"Message is required"}],username:[function(e){return!!e||"Username is required"},function(e){return e&&e.length>2||"Username must be a least 3 characters"}],name:[function(e){return!!e||"Is required"}],title:[function(e){return!!e||"Is required"}]}},719:function(e,t,n){"use strict";function r(e){if("function"!=typeof e.getRootNode){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}var t=e.getRootNode();return t!==document&&t.getRootNode({composed:!0})!==document?null:t}n.d(t,"a",(function(){return r}))},720:function(e,t,n){"use strict";n.r(t);var r=n(273),o={name:"ElementH3",props:{text:{type:String,default:function(){return""}},align:{type:String,default:"center"},prependIcon:{type:String,default:null},iconColor:{type:String,default:null}}},c=n(58),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h3",{class:"no-break text-"+e.align+" text-h5 text-md-h4 text-lg-h3",staticStyle:{"letter-spacing":"0px !important"}},[e.prependIcon?n(r.a,{attrs:{color:e.iconColor}},[e._v("\n    "+e._s(e.prependIcon)+"\n  ")]):e._e(),e._v("\n  "+e._s(e.text)+"\n")],1)}),[],!1,null,null,null);t.default=component.exports}}]);