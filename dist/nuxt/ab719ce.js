(window.webpackJsonp=window.webpackJsonp||[]).push([[132,68],{1e3:function(e,t,r){"use strict";r(922)},1001:function(e,t,r){var n=r(38)(!1);n.push([e.i,"#map-wrap[data-v-14796375]{margin-top:10px;height:100%;width:100%;height:calc(100vh - 160px)}#leafletEl[data-v-14796375],.vue2leaflet-map[data-v-14796375]{z-index:0}.map-actions[data-v-14796375]{bottom:40vh;right:12px}.map-actions[data-v-14796375],.map-search[data-v-14796375]{position:absolute;z-index:5}.map-search[data-v-14796375]{left:12px;top:12px;margin-right:12px}.map-slider[data-v-14796375]{position:absolute;z-index:1;width:100%;bottom:7vh}",""]),e.exports=n},1064:function(e,t,r){"use strict";r.r(t);var n=r(693),l=r(163),o=r(0),c=(r(4),r(16),r(25),r(14),r(5)),d=Object(c.b)({name:"MapPage",middleware:"authenticated",transition:function(e,t){return t&&+e.query.page<+t.query.page?"slide-right":"slide-left"},setup:function(){var e=Object(c.q)(),t=e.state,r=e.dispatch,n=Object(c.l)(),l=n.$config,d=n.$capacitor,f=n.$system,v=n.$vuetify,m=n.$helper,y=Object(c.i)(!0),h=Object(c.i)(null),w=Object(c.i)([]),T=Object(c.a)((function(){return t.user.gps})),x=Object(c.a)((function(){return t.user})),O=Object(c.i)([]),j=Object(c.i)([]),k=Object(c.i)(!1),_=Object(c.i)(!1),C=Object(c.i)(null),M=Object(c.i)(!1),S=Object(c.i)(!1),P=Object(c.i)(!1),I=Object(c.i)({});d.positionPermissions(),Object(c.m)(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:case"end":return e.stop()}}),e)}))));var L=function(e){var t=e.title,title=void 0===t?"Marker":t,r=e.label,label=void 0===r?null:r,n=e.lat,l=void 0===n?null:n,o=e.lng,c=void 0===o?null:o,d=e.content,content=void 0===d?null:d,f=e.iconUrl,v=void 0===f?"MapIconScaled.svg":f,m=e.iconX,y=void 0===m?30:m,h=e.iconY,w=void 0===h?30:h,T=e.id,x=void 0===T?null:T;I.value[x]=new window.google.maps.Marker({map:C.value,position:new window.google.maps.LatLng(l,c),title:title,label:label,icon:{url:"map/".concat(v),scaledSize:new window.google.maps.Size(y,w),origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(y/2,w/2)}});var O='<div id="content">'.concat(content,"</div>"),j=new window.google.maps.InfoWindow({content:O,maxWidth:200});I.value[x].addListener("click",(function(){j.open({anchor:I.value[x],map:C.value,shouldFocus:!1})}))},R=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y.value=!0,e.next=4,r("user/friends/getAll",{uid:x.value.uid}).then((function(e){!1!==e&&(w.value=e)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),f.log({comp:"MapPage",msg:"Not able to get friends for map",val:e.t0});case 9:return e.prev=9,y.value=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(){return e.apply(this,arguments)}}(),A=function(e){var t,r=e.lat,n=void 0===r?null:r,l=e.lng,o=void 0===l?null:l;n&&o&&(t=new window.google.maps.LatLng(n,o),C.value.panTo(t))},D=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.value&&C.value.addListener("dragend",Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.value=[C.value.getCenter().lat(),C.value.getCenter().lng()],console.log("STICKY: Your dragging the map around, new center is",O.value);case 2:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.sleep(1500);case 2:C.value=new window.google.maps.Map(document.getElementById("map"),{zoom:13,mapTypeId:window.google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0}),window.currentMap=C.value,x.value.gps.lat?(console.log("Init map with a center of",x.value.gps.lat),A({lat:x.value.gps.lat,lng:x.value.gps.lng})):console.log("STICKY: not able to center map with empty coords"),v.theme.dark?C.value.setOptions({styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"geometry",stylers:[{color:"#242A33"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242A33"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#abc6b4"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#abc6b4"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#666666"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#666666"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#999999"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b5b5b5"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]}):C.value.setOptions({styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"geometry",stylers:[{color:"#F6F8FA"}]},{elementType:"labels.text.stroke",stylers:[{color:"#F6F8FA"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#abc6b4"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#abc6b4"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#dddddd"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#dddddd"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#999999"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#b5b5b5"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b5b5b5"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#d4e7f9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#d4e7f9"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#d4e7f9"}]}]}),k.value=!0,_.value=!0;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.f)(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P.value=!0;try{T.value&&T.value.lat||d.watchPosition()}catch(e){f.log({comp:"MapPage",msg:"Not able to get position",val:e})}finally{y.value=!1}case 2:case"end":return e.stop()}}),e)})))),Object(c.g)((function(){d.clearWatchPosition()})),Object(c.s)(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P.value){e.next=13;break}if(!window.google||!0===k.value||C.value){e.next=13;break}return e.next=4,F();case 4:return e.next=6,D();case 6:if(!x.value.gps||!x.value.gps.lat){e.next=9;break}return e.next=9,L({id:x.value.data.uid,lat:x.value.gps.lat,lng:x.value.gps.lng,title:"You",content:"You"});case 9:if(console.log("STICKY: INIT MAP DONE"),!(!S.value&&w.value&&w.value.length>0)){e.next=13;break}return e.next=13,void((t=w.value)&&(S.value=!0,t.forEach((function(e){e.gps&&e.gps.lat&&e.permissions.shareLocationWithFriends&&L({id:e.id,lat:e.gps.lat,lng:e.gps.lng,iconUrl:"FriendIcon.svg",title:"".concat(e.first_name?e.first_name:e.username),content:'<div class="d-flex align-center"><v-img src="'.concat(e.photoURL,'" /><h4>').concat(e.first_name?e.first_name:e.username,"</h4></div>")})}))));case 13:case"end":return e.stop()}var t}),e)})))),Object(c.r)(T,(function(e,t){var marker,r,n;console.log("STICKY: WATCH GPS",T.value,t),parseFloat(e.lat)!==t.lat&&T.value&&!0===k.value&&(marker=I[x.value.data.uid],r=T.value.lat,n=T.value.lng,marker&&marker.setPosition(new window.google.maps.LatLng(r,n)))})),Object(c.n)({title:"".concat(l.appTitle," on Map view"),meta:[{hid:"description",name:"description",content:"".concat(l.appTitle," on Map view")}]}),{loading:y,friends:w,googleMapEl:h,gps:T,slider:j,mapError:M,user:x,centerOn:A}},head:{}}),f=d,v=(r(1e3),r(37)),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"map-actions"},[r("div",[r(n.a,{attrs:{elevation:"0",fab:"",small:"",color:"primary"},on:{click:function(t){return e.centerOn({lat:e.user.gps.lat,lng:e.user.gps.lng})}}},[r(l.a,[e._v("\n          mdi-crosshairs-gps\n        ")])],1)],1)]),e._v(" "),r("div",{ref:"googleMapEl",staticStyle:{width:"calc(100vw)",height:"calc(100vh - 75px)"},attrs:{id:"map"}}),e._v(" "),r("div",{staticClass:"map-slider"},[r("FriendsMapslider",{attrs:{friends:e.friends}})],1)])}),[],!1,null,"14796375",null);t.default=component.exports;installComponents(component,{FriendsMapslider:r(947).default})},756:function(e,t,r){"use strict";r.r(t);var n=r(266),l=r(723),o=r(720),c=r(693),d=r(163),f=r(749),v=(r(56),r(46),r(58),r(43),r(5)),m=Object(v.b)({name:"UserAvatar",props:{user:{type:Object,default:function(){return{}}},size:{type:Number,default:function(){return 50}},color:{type:String,default:function(){return"black"}}},setup:function(e){var t=Object(v.q)(),r=t.getters,n=t.state,l=Object(v.o)(),o=Object(v.a)((function(){return r["user/isLoggedIn"]})),c=Object(v.a)((function(){return n.user.profile.initial})),d=Object(v.a)((function(){return n.user.profile.photoURL})),f=Object(v.a)((function(){return n.user.profile})),m=Object(v.i)("offline"),y=Object(v.i)(!1),h=Object(v.i)("/users/user/".concat(e.user.id));n.user.profile.isOnline&&n.user.profile.isOnline.status&&(m.value=n.user.profile.isOnline.status),e.user&&(c=Object(v.a)((function(){return e.user.initial})),d=Object(v.a)((function(){return e.user.photoURL})),e.user.isOnline&&e.user.isOnline.status&&(m.value=e.user.isOnline.status)),f.value.id===e.user.id&&(h.value="/profile");return{isLoggedIn:o,initial:c,photo:d,goTo:h,onlineStatus:m,viewPhoto:y,tappedPhoto:function(){l.value.name.includes("users-user-id")&&(y.value=!0)}}}}),y=r(37),component=Object(y.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"inline-block"}},[r(l.a,{attrs:{top:"",dot:"",overlap:"",bordered:"","offset-x":"8","offset-y":"8",color:"online"===e.onlineStatus?"myshoutGreen":"myshoutRed"}},[r(n.a,{staticClass:"rounded-lg",attrs:{color:e.color,size:e.size,rounded:""}},[e.isLoggedIn?e.isLoggedIn&&e.photo?r(f.a,{attrs:{src:e.photo},on:{click:e.tappedPhoto}}):e.isLoggedIn?r("span",{staticClass:"white--text headline"},[e._v(e._s(e.initial))]):e._e():r(d.a,{attrs:{dark:""}},[e._v("\n        mdi-account\n      ")])],1)],1),e._v(" "),e.viewPhoto?r(o.a,{staticClass:"elevation-0",staticStyle:{"box-shadow":"none !important"},attrs:{"hide-overlay":!0,scrollable:!1,width:"100%","max-width":"700"},model:{value:e.viewPhoto,callback:function(t){e.viewPhoto=t},expression:"viewPhoto"}},[r("div",{staticStyle:{"margin-bottom":"45%"}},[r(f.a,{staticClass:"elevation-12 rounded-lg mx-1",attrs:{src:e.photo}}),e._v(" "),r("div",{staticClass:"text-center"},[r(c.a,{staticClass:"mt-n7",attrs:{color:"primary",fab:""},on:{click:function(t){e.viewPhoto=!e.viewPhoto}}},[r(d.a,[e._v("mdi-close")])],1)],1)],1)]):e._e()],1)}),[],!1,null,null,null);t.default=component.exports},864:function(e,t,r){var content=r(901);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(39).default)("84cf2f08",content,!0,{sourceMap:!1})},900:function(e,t,r){"use strict";r(864)},901:function(e,t,r){var n=r(38)(!1);n.push([e.i,".friend-card-map .map-title[data-v-182a109c]{word-break:normal;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:0;letter-spacing:-.5px;font-size:.85rem}.theme--dark.v-sheet[data-v-182a109c]{background-color:#fff}.card-image[data-v-182a109c]{height:130px;width:100%}.missing-image[data-v-182a109c]{opacity:.25}",""]),e.exports=n},922:function(e,t,r){var content=r(1001);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(39).default)("6cc07be1",content,!0,{sourceMap:!1})},947:function(e,t,r){"use strict";r.r(t);var n=r(720),l=r(693),o=r(725),c=r(924),d=r(75),f=r(860),v=r(923),m=r(280),y=r(5),h=Object(y.b)({name:"FriendsMapslider",directives:{Touch:m.a},props:{friends:{type:Array,default:function(){return[]}}},setup:function(e){var t=Object(y.l)().$vuetify,r=Object(y.p)(),n=Object(y.i)(null),l=Object(y.a)((function(){return t.breakpoint.smAndDown?2:3})),o=Object(y.i)(!1),c=Object(y.i)(null);return{howManyPlaceholders:l,model:n,showSheet:o,sheetData:c,swipe:function(e){"Down"===e&&(o.value=!1)},goTo:function(t){if(e.friends[t]&&e.friends[t]&&e.friends[t].gps&&e.friends[t].gps.lat){var n=new window.google.maps.LatLng(e.friends[t].gps.lat,e.friends[t].gps.lng);window.currentMap.panTo(n),o.value=!0,c.value=e.friends[t]}else r.push("/users/user/".concat(e.friends[t].id))}}}}),w=(r(900),r(37)),component=Object(w.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.friends?r("div",[r(f.b,{staticClass:"pa-0",attrs:{"show-arrows":e.$vuetify.breakpoint.mdAndUp,"active-class":"success","center-active":""},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},e._l(e.friends,(function(t,n){return r(v.a,{key:n},[r("div",[r(c.a,{scopedSlots:e._u([{key:"default",fn:function(l){var c=l.hover;return[r(o.a,{staticClass:"ma-2 pa-1 rounded-lg friend-card-map d-flex align-center ",attrs:{elevation:c?4:0,width:(e.$vuetify.breakpoint.smAndDown,"165")},on:{click:function(t){return e.goTo(n)}}},[r("UserAvatar",{staticClass:"mr-4",attrs:{user:t}}),e._v(" "),r("div",[e._v(e._s(t.username))])],1)]}}],null,!0)})],1)])})),1),e._v(" "),r(n.a,{staticClass:"bottom-sheet",attrs:{scrollable:!0,inset:"","max-width":"700"},model:{value:e.showSheet,callback:function(t){e.showSheet=t},expression:"showSheet"}},[r(d.a,{staticClass:"pa-5 overflow-y-auto rounded-t-xl slide-up",staticStyle:{"padding-bottom":"180px"},attrs:{height:"35vh"}},[r("GlobalSlidebar",{directives:[{def:m.b,name:"touch",rawName:"v-touch",value:{down:function(){return e.swipe("Down")}},expression:"{ down: () => swipe('Down') }"}],nativeOn:{click:function(t){return e.swipe("Down")}}}),e._v(" "),r("div",[r("div",{staticClass:"d-flex align-center mb-12"},[r("UserAvatar",{key:""+Math.random(),staticClass:"mr-4",attrs:{user:e.sheetData}}),e._v(" "),e.sheetData&&e.sheetData.username?r("ElementH3",{staticClass:"mt-0 mb-4",attrs:{text:e.sheetData.username,align:"left"}}):e._e()],1),e._v(" "),e.sheetData?r(l.a,{staticClass:"elevation-0",attrs:{to:"/users/user/"+e.sheetData.id,primary:""}},[e._v("\n\n            "+e._s(e.$t("view_more"))+"\n          ")]):e._e()],1)],1)],1)],1):e._e()])}),[],!1,null,"182a109c",null);t.default=component.exports;installComponents(component,{UserAvatar:r(756).default,GlobalSlidebar:r(399).default,ElementH3:r(395).default})}}]);